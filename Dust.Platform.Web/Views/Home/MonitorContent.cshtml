@using Dust.Platform.Storage.Model
@using Dust.Platform.Web.Models.Home
@model MonitorContentPost
@{
    Layout = null;
}

<div class="col-lg-6" style="height: 100%; padding: 2px;">
    <div class="map panel panel-info" id="@Model.MapContainer"></div>
    <div class="targetInfo">
        <div class="panel panel-info" style="max-height: 100%;">
            <div class="panel-heading">
                <span>@Model.Title 统计信息</span>
            </div>
            <div class="panel-body">

                @switch (Model.ViewType)
                {
                    case AverageCategory.WholeCity:
                        <table id="@($"gtable_{Model.TargetId}")" data-page-size="100">
                            <thead>
                                <tr>
                                    <th>区县</th>
                                    <th>工程总数</th>
                                    <th>已安装数</th>
                                    <th>安装率</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var info in Model.DistrictInfos)
                    {
                                    <tr>
                                        <td>@info.DistrictName</td>
                                        <td>@info.ProjectsCount</td>
                                        <td>@info.ProjectsInstalled</td>
                                        <td>@info.InstallPercentage</td>
                                    </tr>
                                }

                            </tbody>
                        </table>
                        break;
                    case AverageCategory.District:
                        <table id="@($"gtable_{Model.TargetId}")" data-toggle="table" data-page-size="100">
                            <thead>
                                <tr>
                                    <th>工程</th>
                                    <th>监控点数</th>
                                    <th>占地面积(㎡)</th>
                                    <th>建筑面积(㎡)</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var info in Model.DistrictStatuses)
                    {
                                    <tr>
                                        <td>@info.ProjectName</td>
                                        <td>@info.DevicesCount</td>
                                        <td>@info.TotalOccupiedArea</td>
                                        <td>@info.TotalFloorage</td>
                                    </tr>
                                }

                            </tbody>
                        </table>
                        break;
                    case AverageCategory.Enterprise:
                        <table id="@($"gtable_{Model.TargetId}")" data-toggle="table" data-page-size="100">
                            <thead>
                                <tr>
                                    <th>工程</th>
                                    <th>监控点数</th>
                                    <th>占地面积(㎡)</th>
                                    <th>建筑面积(㎡)</th>
                                </tr>
                            </thead>
                            <tbody>

                                @foreach (var info in Model.DistrictStatuses)
                    {
                                    <tr>
                                        <td>@info.ProjectName</td>
                                        <td>@info.DevicesCount</td>
                                        <td>@info.TotalOccupiedArea</td>
                                        <td>@info.TotalFloorage</td>
                                    </tr>
                                }

                            </tbody>
                        </table>
                        break;
                    case AverageCategory.Project:
                        <table class="table table-bordered table-striped table-hover">
                            <thead></thead>
                            <tbody>
                                <tr>
                                    <td>合同备案号：</td>
                                    <td>@Model.Project.ContractRecord</td>
                                    <td>设备厂商：</td>
                                    <td>@Model.Project.Vendor.Name</td>
                                </tr>
                                <tr>
                                    <td>工程名称：</td>
                                    <td>@Model.Project.Name</td>
                                    <td>所属区县：</td>
                                    <td>@Model.Project.District.Name</td>
                                </tr>
                                <tr>
                                    <td>建设单位：</td>
                                    <td>@Model.Project.ConstructionUnit</td>
                                    <td>施工单位：</td>
                                    <td>@Model.Project.Enterprise.Name</td>
                                </tr>
                                <tr>
                                    <td>工程地址：</td>
                                    <td>@Model.Project.Address</td>
                                    <td>负责人：</td>
                                    <td>@Model.Project.SuperIntend</td>
                                </tr>
                                <tr>
                                    <td>联系电话：</td>
                                    <td>@Model.Project.Mobile</td>
                                    <td>工程状态：</td>
                                    @{ var prjStatus = Model.Project.Stopped ? "停工" : "在建";}
                                    <td>@prjStatus</td>
                                </tr>
                            </tbody>
                        </table>
                                            break;
                                        case AverageCategory.Device:
                                            <table class="table table-bordered table-striped table-hover">
                                                <thead></thead>
                                                <tbody>
                                                    <tr>
                                                        <td>设备名称：</td>
                                                        <td>@Model.Device.Name</td>
                                                        <td>设备厂商：</td>
                                                        <td>@Model.Device.Vendor.Name</td>
                                                    </tr>
                                                    <tr>
                                                        <td>所属区县：</td>
                                                        <td>@Model.Device.Project.District.Name</td>
                                                        <td>工程地址：</td>
                                                        <td>@Model.Device.Project.Address</td>
                                                    </tr>
                                                    <tr>
                                                        <td>建设单位：</td>
                                                        <td>@Model.Device.Project.ConstructionUnit</td>
                                                        <td>施工单位：</td>
                                                        <td>@Model.Device.Project.Enterprise.Name</td>
                                                    </tr>
                                                    <tr>
                                                        <td>负责人：</td>
                                                        <td>@Model.Device.Project.SuperIntend</td>
                                                        <td>联系电话：</td>
                                                        <td>@Model.Device.Project.Mobile</td>
                                                    </tr>
                                                    <tr>
                                                        <td>安装时间：</td>
                                                        <td>@Model.Device.InstallDateTime</td>
                                                        <td>在线状态：</td>
                                                        @{ var devStatus = Model.Device.IsOnline ? "在线" : "离线";}
                                                        <td>@devStatus</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                                                break;
                                                            }

            </div>
        </div>
    </div>
</div>
<div class="col-lg-6" style="height: 100%; padding: 2px;">
    <div class="panel panel-info" style="height: 48%; margin-bottom: 1%;">
        <div class="panel panel-info">
            <div class="panel-heading">
                <span>@Model.Title 最近24小时变化趋势</span>
                <select id="@Model.Selecter" class="form-control" style="float: right; padding: 0;height: 20px;width: 160px;">
                    <option value="0">粉尘(mg/m³)</option>
                    <option value="3">噪音(mg/m³)</option>
                    <option value="4">温度(℃)</option>
                    <option value="5">湿度(%)</option>
                    <option value="6">风速(m/s)</option>
                </select>
            </div>
            <div class="panel-body">
                <div id="@Model.Chart"></div>
            </div>
        </div>
    </div>
    <div class="panel panel-info" style="height: 48%;">
        <div class="panel-heading">
            <span>@Model.Title 最近24小时监测数据</span>
        </div>
        <div class="panel-body">
            @(Html.BootstrapTable(null, TablePaginationOption.server, new
            {
                id = $"dtable_{Model.TargetId}",
                data_page_size = 50,
                data_sort_name = "AverageDateTime",
                data_sort_order = "desc",
                url = $"/Home/MonitorLastDayData?id={Model.TargetId}&type={Model.ViewType}&start={DateTime.Now.AddDays(-1):yyyy-MM-dd HH:mm:ss}&end={DateTime.Now:yyyy-MM-dd HH:mm:ss}"
            }).Column("粉尘", "ParticulateMatter", true)
                                             .Column("PM2.5", "Pm25")
                                             .Column("PM10", "Pm100")
                                             .Column("噪音", "Noise")
                                             .Column("温度", "Temperature")
                                             .Column("湿度", "Humidity")
                                             .Column("监测时间", "AverageDateTime", true)
            )
        </div>

    </div>
</div>
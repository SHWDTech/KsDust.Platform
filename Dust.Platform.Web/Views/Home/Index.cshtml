@using Dust.Platform.Web.Models.Home
@using Newtonsoft.Json
@model IndexViewModel
@{
    ViewBag.Title = "首页";
}

@section styles{
    <link href="/Content/bootstrap-table.min.css" rel="stylesheet" />
}
<div style="position: relative; height: 100%;">
    <div class="col-lg-4" style="height: 100%;">
        <div class="panel panel-info" style="height: 40%; min-height: 40%; margin-bottom: 1%;">
            <div class="panel-heading">全市工地信息汇总</div>
            <div class="panel-body">
                <table id="districtTable" data-toggle="table" data-page-size="100">
                    <thead>
                        <tr>
                            <th>区县名称</th>
                            <th>工程总计</th>
                            <th>已安装工程</th>
                            <th>安装率</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{
                            foreach (var districtInfo in Model.DistrictInfos)
                            {
                                <tr>
                                    <td>@districtInfo.DistrictName</td>
                                    <td>@districtInfo.ProjectsCount</td>
                                    <td>@districtInfo.ProjectsInstalled</td>
                                    <td>@districtInfo.InstallPercentage</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
        </div>
        <div class="panel panel-info" style="height: 29%; min-height: 29%; margin-bottom: 1%;">
            <div class="panel-heading">厂家信息汇总</div>
            <div class="panel-body">
                <table id="enterpriseTable" data-toggle="table" data-page-size="100">
                    <thead>
                        <tr>
                            <th>厂商名称</th>
                            <th>设备总数</th>
                            <th>在线数</th>
                            <th>离线数</th>
                            <th>在线率</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{
                            foreach (var enterprise in Model.Enterpriseses)
                            {
                                <tr>
                                    <td>@enterprise.EnterpriseName</td>
                                    <td>@enterprise.DevicesCount</td>
                                    <td>@enterprise.OnlineCount</td>
                                    <td>@enterprise.OfflineCount</td>
                                    <td>@enterprise.OnlinePercentage</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
        </div>
        <div class="panel panel-info" style="height: 29%; min-height: 29%;">
            <div class="panel-heading">接入厂家信息</div>
            <div class="panel-body">
                <table id="vendorTable" data-toggle="table" data-page-size="100">
                    <thead>
                        <tr>
                            <th>厂商名称</th>
                            <th>负责人</th>
                            <th>联系电话</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{
                            foreach (var vendor in Model.VendorInfos)
                            {
                                <tr>
                                    <td>@vendor.VendroName</td>
                                    <td>@vendor.Susperintend</td>
                                    <td>@vendor.Mobile</td>
                                </tr>
                            }
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="col-lg-8" style="height: 100%">
        <div class="panel panel-info" style="height: 48.5%; min-height: 48.5%; margin-bottom: 1%;">
            <div class="panel-heading">全市扬尘指标排名</div>
            <div class="panel-body">
                <div id="districtTopten"></div>
            </div>
        </div>
        <div class="panel panel-info" style="height: 48.5%; min-height: 48.5%;">
            <div class="panel-heading">全市工程粉尘浓度排名TOP10</div>
            <div class="panel-body">
                <div id="projectTopten"></div>
            </div>
        </div>
    </div>
</div>
@section scripts{
    <script type="text/javascript">
        var districtTopTen = JSON.parse('@Html.Raw(JsonConvert.SerializeObject(Model.DistrictRanks))');
        var prjTopTen = JSON.parse('@Html.Raw(JsonConvert.SerializeObject(Model.ProjectRanks))');
        $(function () {
            $('#districtTable').attr('data-height', $('#districtTable').parents('.panel-info').height() - 28);
            $('#enterpriseTable').attr('data-height', $('#enterpriseTable').parents('.panel-info').height() - 28);
            $('#vendorTable').attr('data-height', $('#vendorTable').parents('.panel-info').height() - 28);
        });
    </script>
    <script src="/Scripts/bootstrap-table/bootstrap-table.min.js"></script>
    <script src="/Scripts/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
    <script src="~/Scripts/Utility/chartsOption.js"></script>
    <script src="~/Scripts/Page/index.js"></script>
}
